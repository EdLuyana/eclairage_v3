{% extends 'base.html.twig' %}

{% block title %}Consultation des stocks{% endblock %}

{% block body %}
<h1 class="mb-4">ðŸ“¦ Consultation des stocks</h1>

<form method="get" class="mb-4 row g-2">
    <div class="col-md-4">
        <label for="location" class="form-label">Magasin</label>
        <select name="location" id="location" class="form-select">
            <option value="">Tous les magasins</option>
            {% for loc in locations %}
            <option value="{{ loc.id }}" {{ locationId == loc.id ? 'selected' }}>
            {{ loc.name }}
            </option>
            {% endfor %}
        </select>
    </div>
    <div class="col-md-2 align-self-end">
        <button class="btn btn-primary w-100">ðŸ”Ž Filtrer</button>
    </div>
</form>

<table class="table table-bordered align-middle">
    <thead class="table-light">
    <tr>
        <th>RÃ©fÃ©rence</th>
        <th>Magasin</th>
        <th>Taille</th>
        <th>Stock</th>
        <th>Ventes (30j)</th>
    </tr>
    </thead>
    <tbody>
    {% for stock in stocks %}
    {% set salesCount = sales[stock.product.id][stock.size]|default(0) %}
    <tr>
        <td>{{ stock.product.reference }}</td>
        <td>{{ stock.location.name }}</td>
        <td>{{ stock.size }}</td>
        <td>
            {% if stock.quantity == 0 %}
            <span class="badge bg-danger">0</span>
            {% elseif stock.quantity == 1 %}
            <span class="badge bg-warning text-dark">1</span>
            {% else %}
            <span class="badge bg-success">{{ stock.quantity }}</span>
            {% endif %}
        </td>
        <td>{{ salesCount }}</td>
    </tr>
    {% else %}
    <tr>
        <td colspan="5" class="text-center text-muted">Aucun stock trouvÃ©.</td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% endblock %}
